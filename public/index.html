<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kwadraty na Canvasie - Sterowanie przez Serwer</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 50px; }
        canvas { border: 1px solid #000; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Kwadraty na Canvasie - Sterowanie przez Serwer</h1>
    <canvas id="gameCanvas" width="500" height="500"></canvas>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        // Połączenie z serwerem
        const socket = io();

        // Inicjalizacja canvasu i jego kontekstu
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Kwadraty i ich właściwości - przechowujemy pozycje wszystkich graczy
        let squares = {};

        // Funkcja rysująca kwadraty
        function drawSquares() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Czyść canvas przed każdym rysowaniem

            // Rysowanie kwadratów wszystkich graczy
            for (let playerId in squares) {
                let square = squares[playerId];
                ctx.fillStyle = playerId === socket.id ? '#FF0000' : '#00FF00'; // Czerwony dla własnego kwadratu, zielony dla innych
                ctx.fillRect(square.x, square.y, square.size, square.size); // Rysowanie kwadratu
            }
        }

        // Nasłuchiwanie na zmianę pozycji kwadratów z serwera
        socket.on('square-position', (players) => {
            squares = players;
            drawSquares(); // Rysowanie wszystkich kwadratów
        });

        // Funkcja do kontrolowania ruchu kwadratu
        function controlSquare(event) {
            switch (event.key) {
                case 'ArrowUp':
                    socket.emit('move-square', 'up');
                    break;
                case 'ArrowDown':
                    socket.emit('move-square', 'down');
                    break;
                case 'ArrowLeft':
                    socket.emit('move-square', 'left');
                    break;
                case 'ArrowRight':
                    socket.emit('move-square', 'right');
                    break;
            }
        }

        // Nasłuchiwanie na naciśnięcie klawiszy (strzałki)
        window.addEventListener('keydown', controlSquare);

        // Rysowanie początkowych kwadratów
        drawSquares();
    </script>
</body>
</html>
